<!doctype html>
<html lang="en">

<head>
    <title>Title</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container ">
        <table class="table table-bordered mt-3">
            <thead>
                <tr>
                    <th>產品</th>
                    <th>單價</th>
                    <th>數量</th>
                    <th>價格</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <h3>咖啡</h3>
                    </td>
                    <td>
                        <input type="number" readonly class="form-control" id="price1" value="100">
                    </td>
                    <td>
                        <input type="number" class="form-control" id="count1" value="0">
                    </td>
                    <td>
                        <input type="text" readonly class="form-control" id="total1" value="0">
                    </td>
                </tr>
                <tr>
                    <td>
                        <h3>蛋糕</h3>
                    </td>
                    <td>
                        <input type="number" readonly class="form-control" id="price2" value="150">
                    </td>
                    <td>
                        <input type="number" class="form-control" id="count2" value="0">
                    </td>
                    <td>
                        <input type="text" readonly class="form-control" id="total2" value="0">
                    </td>
                </tr>
                <tr>
                    <td>
                        <h3>果汁</h3>
                    </td>
                    <td>
                        <input type="number" readonly class="form-control" id="price3" value="50">
                    </td>
                    <td>
                        <input type="number" class="form-control" id="count3" value="0">
                    </td>
                    <td>
                        <input type="text" readonly class="form-control" id="total3" value="0">
                    </td>
                </tr>
                <tr>
                    <td>
                        <h3>總價</h3>
                    </td>
                    <td colspan="2" id="alltotal">
                        <span id="result">

                        </span>
                    </td>
                    <td style="text-align: center;">
                        <button type="button" class="btn btn-success" id="totalbtn">總計(滿500打8折)</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        $(function () {
            function item1Fun() {
                let getItem1Price = Number(price1.val());
                let getItem1Num = Number(count1.val());
                let resultItem1Total = getItem1Price * getItem1Num;
                total1.val(resultItem1Total);
            }
            function item2Fun() {
                let getItem2Price = Number(price2.val());
                let getItem2Num = Number(count2.val());
                let resultItem2Total = getItem2Price * getItem2Num;
                total2.val(resultItem2Total);
            }
            function item3Fun() {
                let getItem3Price = Number(price3.val());
                let getItem3Num = Number(count3.val());
                let resultItem3Total = getItem3Price * getItem3Num;
                total3.val(resultItem3Total);
            }
            const price1 = $('#price1');
            const count1 = $('#count1');
            const total1 = $('#total1');
            const price2 = $('#price2');
            const count2 = $('#count2');
            const total2 = $('#total2');
            const price3 = $('#price3');
            const count3 = $('#count3');
            const total3 = $('#total3');
            const totalbtn = $('#totalbtn');
            const result = $('#result');
            
            // item1
            price1.change(function (e) {
                item1Fun();
            });
            count1.change(function (e) {
                item1Fun();
            });
            price2.change(function (e) {
                item2Fun();
            });
            count2.change(function (e) {
                item2Fun();
        });
        price3.change(function (e) {
            item3Fun();
        });
        count3.change(function (e) {
            item3Fun();
        });
        
        totalbtn.click(function (e) {
            let getItem1total = Number(total1.val());
            let getItem2total = Number(total2.val());
            let getItem3total = Number(total3.val());
            let sum = getItem1total + getItem2total + getItem3total;
            if (sum >= 500) {
                sum = sum * 0.8;
            }
            result.text(sum);
        })
    })
        
        
        </script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
</body>

</html>